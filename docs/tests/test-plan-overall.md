# 全体テスト計画 (初期)

## 目的
MVP の品質基準とカバレッジ方針を定義。

## スコープ
- 単体 (utils / components)
- 統合 (Server Actions + DB RLS)
- E2E (主要ユーザーフロー)
- 非機能 (基本性能指標確認)

## カバレッジ目標
| レイヤ | 目標 |
|--------|------|
| 単体 | 行 70% / 分岐 60% |
| Server Actions | 主要 Happy + エラー 100% |
| RLS | アクセス拒否パターン網羅 |
| E2E | 主要フロー (Auth→Profile→Work登録) |

## テストカテゴリ
| 種別 | 例 |
|------|----|
| バリデーション | Zod スキーマ境界 |
| 権限 | 他ユーザー更新拒否 |
| 回復力 | ネットワーク一時失敗 retry |

## ケース一覧 (抜粋)
| ID | 種別 | 条件 | 期待結果 |
|----|------|------|----------|
| UT-PROFILE-01 | 単体 | display_name 0長 | 422 |
| UT-WORK-01 | 単体 | tags=16個 | 422 |
| IT-RLS-01 | 統合 | 他人作品更新 | 403 |
| E2E-CORE-01 | E2E | 新規登録→作品作成 | 成功 |

## モック戦略
- Supabase client: 統合以外は軽量モック
- RLS テスト: 実 DB コンテナ or local supabase

## 非機能 (初期)
- P95 Work 作成 < 400ms
- 連続 50 リクエストでエラー率 < 1%

## リスク
- Server Actions の計測ポイント未注入
- ローカル supabase セットアップ差異

## 未決
- Playwright 並列度
- 負荷テストツール選定 (k6 予定)

